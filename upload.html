<!DOCTYPE html>
<html lang="en">

<head>


    <title>DHIRAJHUB</title>



    <meta name='asg_verification' content='Mqwq9tTYzYsUB7TqUwKyLRMG'>


    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <script src="https://kit.fontawesome.com/c2614694fb.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <link href="./css/all-responsive-white.css@v=7.css" rel="stylesheet" type="text/css" />

    <script src="./js/jQuery.js"></script>
    <script src="./js/main.js"></script>
    <script src="./js/script.js"></script>
    <script src="./js/shuffle.js"></script>
    <script src="./js/drop.js"></script>
    <!---->
    <link href="./css/upload.css" rel="stylesheet" type="text/css" />
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->

    <!-- Add Firebase products that you want to use -->


    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-auth.js"></script>






    <script type="module">
        // Import the functions you need from the SDKs you need
        //import { initializeApp } from "https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js";
        // import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/8.4.1/firebase-database.js";

        // Your web app's Firebase configuration

    </script>

    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyA95rq2gZ2o6JfiH-a2tcPMLi97evcW3mE",
            authDomain: "dhub-09.firebaseapp.com",
            databaseURL: "https://dhub-09-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "dhub-09",
            storageBucket: "gs://dhub-09.appspot.com",
            messagingSenderId: "486177348563",
            appId: "1:486177348563:web:ca1216297cddd106ad6d26",
            measurementId: "G-HSJP70KW1N"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
    </script>





</head>

<body>
    <div class="container" id="container">

        <div class="header">
            <div class="logo" id="logo">
                <a href="/"><img src="./images/logo.jpeg" width="130" height="43" alt=""></a>
            </div>
            <div class="social-bookmarks">
                <!-- AddThis Button BEGIN -->
                <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
                    <div class="member-logs">
                        <a data-href="" data-fancybox="ajax" id="login">Login</a>
                        <a data-href="" data-fancybox="ajax">Sign Up</a>
                    </div>

                </div>
                <script type="text/javascript">
                    var addthis_config = {
                        ui_language: ''
                    }
                </script>
                <script type="text/javascript" src="//s7.addthis.com/js/250/addthis_widget.js" defer></script>
                <!-- AddThis Button END -->
            </div>
            <div class="search">

                <div class="container-switcher">
                    <div class="round">
                        <input type="checkbox" id="checkbox" />

                        <label for="checkbox"></label>
                    </div>
                </div>
            </div>
        </div>

        <nav>
            <div class="navigation">
                <button class="button">
                    <span class="icon">
                        <span class="ico-bar"></span>
                        <span class="ico-bar"></span>
                        <span class="ico-bar"></span>
                    </span>
                </button>
                <ul class="primary">
                    <li>
                        <div class="mobile-menu-auto">
                            <a href="" data-fancybox="ajax">
                                <i class="loginIcon"></i>
                                <span>Login</span>
                            </a>
                            <a href="" data-fancybox="ajax">
                                <i class="registerIcon"></i><span>Signup</span>
                            </a>
                            <a data-href="" data-fancybox="ajax">
                                <i class="uploadBtn"></i>
                                <span>Upload</span>
                            </a>
                        </div>
                    </li>
                    <li class="main-list-menu"><span>MAIN</span></li>
                    <li class="selected">
                        <i class="list-0"></i>
                        <a href="" id="item1">Home</a>
                    </li>

                    <li>
                        <i class="list-2"></i>
                        <a href="" id="item3">Most Popular</a>
                    </li>





                    <li>
                        <i class="list-4"></i>
                        <a href="" id="item8">Pornstar</a>
                    </li>
                    <li>
                        <i class="list-5"></i>
                        <a href="" id="item10">Channels</a>
                    </li>



                    <li>
                        <i class="list-6"></i>
                        <a href="" id="item11">About Us</a>
                    </li>

                    <li class="switch-mobile"></li>
                </ul>
                <ul class="secondary">
                </ul>
            </div>
        </nav>
        <!-------------Mobile--->
        <div class="top-links-mobile">
            <div class="center-hold">
                <div class="member-links">
                    <ul>
                        <li class="selected-link">
                            <a href="/">Home</a>
                        </li>







                        <li>
                            <a href="#" id="item7">Sites</a>
                        </li>
                        <li>
                            <div class="dropdown" onclick="myFunction()">
                                <button class="dropbtn">CATEGORIES</button>
                                <div id="myDropdown" class="dropdown-content">
                                    <a href="/categories/anal" class="nav_dropdown-item">Anal</a>
                                    <a href="/categories/aunty" class="nav_dropdown-item">Aunty</a>
                                    <a href="/categories/arab" class="nav_dropdown-item">Arab</a>
                                    <a href="/categories/asian" class="nav_dropdown-item">Asian</a>
                                    <a href="/categories/bbc" class="nav_dropdown-item">BBC</a>
                                    <a href="/categories/bbw" class="nav_dropdown-item">BBW</a>
                                    <a href="/categories/bhabhi" class="nav_dropdown-item">Bhabhi</a>
                                    <a href="/categories/black" class="nav_dropdown-item">Black</a>
                                    <a href="/categories/cumshot" class="nav_dropdown-item">Cumshot</a>
                                    <a href="/categories/deepthroat" class="nav_dropdown-item">Deepthroat</a>
                                    <a href="/categories/gangbang" class="nav_dropdown-item">Gangbang</a>
                                    <a href="/categories/hardcore" class="nav_dropdown-item">Hardcore</a>
                                    <a href="/categories/hentai" class="nav_dropdown-item">Hentai</a>
                                    <a href="/categories/hindi" class="nav_dropdown-item">Hindi</a>
                                    <a href="/categories/indian" class="nav_dropdown-item">Indian</a>
                                    <a href="/categories/maid" class="nav_dropdown-item">Maid</a>
                                    <a href="/categories/mms" class="nav_dropdown-item">MMS</a>
                                    <a href="/categories/movie" class="nav_dropdown-item">Movie</a>
                                    <a href="/categories/solo" class="nav_dropdown-item">Solo</a>
                                    <a href="/categories/ownerschoice" class="nav_dropdown-item">Owner's Choice</a>

                                </div>
                            </div>
                        </li>
                        <li>
                            <a href="/html/profile" id="item4">ABOUT US</a>
                        </li>
                    </ul>

                </div>
            </div>

        </div>
        <br><br><br><br><br><br>
        <button id="signInButton" class="gsi-material-button" style="width:250px; left: 50px; ">
            <div class="gsi-material-button-state"></div>
            <div class="gsi-material-button-content-wrapper">
                <div class="gsi-material-button-icon">
                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"
                        xmlns:xlink="http://www.w3.org/1999/xlink" style="display: block;">
                        <path fill="#EA4335"
                            d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z">
                        </path>
                        <path fill="#4285F4"
                            d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z">
                        </path>
                        <path fill="#FBBC05"
                            d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z">
                        </path>
                        <path fill="#34A853"
                            d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z">
                        </path>
                        <path fill="none" d="M0 0h48v48H0z"></path>
                    </svg>
                </div>
                <span class="gsi-material-button-contents">Sign in with Google</span>
                <span style="display: none;">Sign in with Google</span>
            </div>
        </button>
        <br><br><br>
        <button id="signOutButton" class="gsi-material-button" style="width:250px; display: none; left: 50px; ">
            <div class="gsi-material-button-state"></div>
            <div class="gsi-material-button-content-wrapper">
                <div class="gsi-material-button-icon">
                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"
                        xmlns:xlink="http://www.w3.org/1999/xlink" style="display: block;">
                        <path fill="#EA4335"
                            d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z">
                        </path>
                        <path fill="#4285F4"
                            d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z">
                        </path>
                        <path fill="#FBBC05"
                            d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z">
                        </path>
                        <path fill="#34A853"
                            d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z">
                        </path>
                        <path fill="none" d="M0 0h48v48H0z"></path>
                    </svg>
                </div>
                <span class="gsi-material-button-contents">Sign out</span>
                <span style="display: none;">Sign out</span>
            </div>
        </button>
        <br><br><br>
        <script>
            document.getElementById('signInButton').addEventListener('click', function () {
                var provider = new firebase.auth.GoogleAuthProvider();
                firebase.auth().signInWithPopup(provider).then(function (result) {
                    // This gives you a Google Access Token. You can use it to access the Google API.
                    // The signed-in user info.
                    console.log('Sign-in successful.');
                }).catch(function (error) {
                    // Handle Errors here.
                    console.error(error);
                });
            });

            document.getElementById('signOutButton').addEventListener('click', function () {
                firebase.auth().signOut().then(function () {
                    console.log('Sign-out successful.');
                }).catch(function (error) {
                    console.error(error);
                });
            });

            firebase.auth().onAuthStateChanged(user => {
                const loginTimestamp = localStorage.getItem('loginTimestamp');
                const now = new Date().getTime();

                if (user) {
                    document.getElementById('signInButton').style.display = 'none';
                    document.getElementById('signOutButton').style.display = 'block';

                    if (!loginTimestamp) {
                        localStorage.setItem('loginTimestamp', now.toString());
                    } else if (now - parseInt(loginTimestamp, 10) > 86400000) { // 86400000 ms = 24 hours
                        // More than 24 hours since login, sign out the user
                        firebase.auth().signOut();
                        localStorage.removeItem('loginTimestamp');
                        alert('Session expired. Please sign in again.');
                        return;
                    }

                    // Show the upload form if user is authenticated and email matches
                    document.getElementById('uploadFormContainer').style.display = 'block';
                } else {
                    // No user is signed in or session expired
                    document.getElementById('signInButton').style.display = 'block';
                    document.getElementById('signOutButton').style.display = 'none';
                    document.getElementById('uploadFormContainer').style.display = 'none';
                    localStorage.removeItem('loginTimestamp'); // Clear the timestamp
                }
            });
        </script>
        <div id="uploadFormContainer" style="display: none;" class="upload">

            <h2>Upload Video</h2><br><br>
            <form id="uploadForm">
                <label> Upload Video file</label><br><br>
                <input type="file" id="videoFile" accept="video/*" required style="accent-color: orange;"><br><br>
                <label> Upload Thumbnail </label><br><br>
                <input type="file" id="imgFile" accept="image/*" required style="accent-color: orange;"><br><br>
                <label>Enter Title for Video</label><br><br>

                <input type="text" id="title" placeholder="Enter Title" required><br><br>
                <label> Select Category </label><br><br>
                <select id="category" required style="accent-color: orange;">
                    <option value="main">MAIN</option>
                    <option value="arab">ARAB</option>
                    <option value="asian">ASIAN</option>
                    <option value="bhabhi">BHABHI</option>
                    <option value="bbc">BBC</option>
                    <option value="bigtits">BIGTITS</option>
                    <option value="blowjob">BLOWJOB</option>
                    <option value="gangbang">GANGBANG</option>
                    <option value="hardcore">HARDCORE</option>
                    <option value="mms">MMS</option>
                    <option value="milf">MILF</option>
                    <option value="exclusive">EXCLUSIVE</option>

                </select><br><br>
                <label>Enter Data-Number</label><br><br>
                <input type="number" id="dataNumber" placeholder="Enter dataNumber" required style="accent-color: orange;"><br><br><br>
                <progress id="uploadProgress" value="0" max="100"
                    style="accent-color: orange; width: 80%; height: 20px; "></progress><br><br><br>

                <span id="uploadPercentage" style="
                    color: orange;
                    font-size: 25px;
                     ">0%</span><br><br><br><br>
                <button id="submit" type="submit">Upload</button><br><br>

            </form>
            <div id="uploadStatus"></div><br><br>
        </div>
        <br><br><br>
    </div>

</body>
<script>
    const storage = firebase.storage();
    const database = firebase.database();

    document.getElementById('uploadForm').addEventListener('submit', function (event) {
        event.preventDefault();

        // Get form values
        const videoFile = document.getElementById('videoFile').files[0];
        const imageFile = document.getElementById('imgFile').files[0];
        const title = document.getElementById('title').value;
        const dataNumber = document.getElementById('dataNumber').value;
        const category = document.getElementById('category').value;
        const uploadProgress = document.getElementById('uploadProgress');
        const uploadPercentage = document.getElementById('uploadPercentage'); // Get the percentage display element

        // Initialize progress variables
        let videoUploadProgress = 0;
        let imageUploadProgress = 0;

        function updateOverallProgress() {
            // Assuming video and image uploads are 90% of progress, database write is 10%
            const totalProgress = (videoUploadProgress * 0.45) + (imageUploadProgress * 0.45);
            uploadProgress.value = totalProgress;
            uploadPercentage.textContent = Math.floor(totalProgress) + '%'; // Update percentage text

            // Complete progress when both uploads are done and database write starts
            if (videoUploadProgress === 100 && imageUploadProgress === 100) {
                uploadProgress.value = 90; // 90% for uploads done
                uploadPercentage.textContent = '90%'; // Update percentage text
            }
        }
        // Upload video to Firebase Storage
        const storagePath = `uploads/${category}/`;
        const databasePath = `uploads/${category}`;

        // Upload video
        const videoUploadTask = firebase.storage().ref(`${storagePath}video/${videoFile.name}`).put(videoFile);

        // Monitor video upload progress
        // Monitor video upload progress
        videoUploadTask.on('state_changed', (snapshot) => {
            // Update progress
            videoUploadProgress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
            updateOverallProgress();
        }, (error) => {
            console.error("Error uploading video:", error);
        }, () => {
            // This is the correct place to get the video URL after upload completes
            videoUploadTask.snapshot.ref.getDownloadURL().then((videoUrl) => {
                console.log('Video URL:', videoUrl);

                // Start the image upload after video upload is successful
                const imageUploadTask = firebase.storage().ref(`${storagePath}image/${imageFile.name}`).put(imageFile);

                // Monitor image upload progress
                imageUploadTask.on('state_changed', (snapshot) => {
                    imageUploadProgress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    updateOverallProgress();
                }, (error) => {
                    console.error("Error uploading image:", error);
                }, () => {
                    // This is the correct place to get the image URL after upload completes
                    imageUploadTask.snapshot.ref.getDownloadURL().then((imageUrl) => {
                        console.log('Image URL:', imageUrl);

                        // Save metadata to the database after both uploads are complete
                        firebase.database().ref(databasePath).push({
                            title: title,
                            dataNumber: dataNumber,
                            videoUrl: videoUrl,
                            imageUrl: imageUrl
                        }).then(() => {
                            uploadProgress.value = 100; // Complete the progress bar
                            uploadPercentage.textContent = '100%'; // Update percentage text to 100%
                            alert('Upload successful!');
                            window.location.reload();
                        });

                    });
                });
            });
        });
    });
</script>


</html>